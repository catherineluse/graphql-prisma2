# Migration `20200430121655`

This migration has been generated by Catherine Luse at 4/30/2020, 12:16:55 PM.
You can check out the [state of the schema](./schema.prisma) after the migration.

## Database Steps

```sql
ALTER TABLE "public"."Comment" DROP CONSTRAINT IF EXiSTS "Comment_commentId_fkey",
DROP COLUMN "commentId",
DROP COLUMN "parentCommentId";

ALTER TABLE "public"."Community" DROP COLUMN "createdDate";

ALTER TABLE "public"."Comment" ADD FOREIGN KEY ("id")REFERENCES "public"."Comment"("id") ON DELETE CASCADE  ON UPDATE CASCADE
```

## Changes

```diff
diff --git schema.prisma schema.prisma
migration 20200427024657-init..20200430121655
--- datamodel.dml
+++ datamodel.dml
@@ -2,9 +2,9 @@
 // learn more about it in the docs: https://pris.ly/d/prisma-schema
 datasource db {
   provider = "postgresql"
-  url = "***"
+  url      = env("DATABASE_URL")
 }
 generator client {
   provider = "prisma-client-js"
@@ -35,21 +35,21 @@
   createdAt     DateTime       @default(now())
 }
 model Comment {
-  id               Int           @id
+  id               Int           @id @default(autoincrement())
   text             String
   author           User          @relation(fields: [authorId], references: [id]) 
   authorId         Int
   discussion       Discussion    @relation(fields: [discussionId], references: [id])
   discussionId     Int
-  parentCommentId  Int?         
-  childComments    Comment[]     
+  parentComment    Comment       @relation("ParentChildComments", fields: [id], references: [id])
+  childComments    Comment[]     @relation("ParentChildComments")
   createdAt        DateTime      @default(now())
 }
 model Message {
-  id           Int         @id
+  id           Int         @id @default(autoincrement())
   text         String
   author       User        @relation(name: "MessageAuthor", fields: [authorId], references: [id])
   authorId     Int         
   recipient    User        @relation(name: "MessageRecipient", fields: [authorId], references: [id])
@@ -57,14 +57,13 @@
   createdAt    DateTime    @default(now())
 }
 model Community {
-  id           Int          @id
+  id           Int          @id @default(autoincrement())
   creator      User         @relation(fields: [creatorId], references: [id])
   creatorId    Int          
   url          String       @unique
   name         String
   description  String?
-  createdDate  String
   discussions  Discussion[]
   createdAt    DateTime     @default(now())
 }
```


